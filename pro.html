<!DOCTYPE html>
 2 <html>
 3     <head>
 4         <title>H5地理位置Demo</title>
 5         <script src="http://api.map.baidu.com/api?v=1.3" type="text/javascript">
 6         </script>
 7         <script type="text/javascript" src="convertor.js">
 8         </script>
 9     </head>
10     <body>
11         <div id="map" style="width:600px; height:400px">
12         </div>
13     </body>
14     <script type="text/javascript">
15         if (window.navigator.geolocation) {
16             var options = {
17                 enableHighAccuracy: true,
18             };
19             window.navigator.geolocation.getCurrentPosition(handleSuccess, handleError, options);
20         } else {
21             alert("浏览器不支持html5来获取地理位置信息");
22         }
23         
24         function handleSuccess(position){
25             // 获取到当前位置经纬度  本例中是chrome浏览器取到的是google地图中的经纬度
26             var lng = position.coords.longitude;
27             var lat = position.coords.latitude;
28             // 调用百度地图api显示
29             var map = new BMap.Map("map");
30             var ggPoint = new BMap.Point(lng, lat);
31             // 将google地图中的经纬度转化为百度地图的经纬度
32             BMap.Convertor.translate(ggPoint, 2, function(point){
33                 var marker = new BMap.Marker(point);
34                 map.addOverlay(marker);
35                 map.centerAndZoom(point, 15);
36             });
37         }
38         
39         function handleError(error){
40         
41         }
42     </script>
43 </html>
